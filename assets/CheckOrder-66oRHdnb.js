import{r as n,u as C,o as E,e as y,a as F,d as u,g as e,q as T,F as U,k as j,t as d,C as B,f as r,w as M,l as w,b as h,c as f,s as p,i as z,h as _,z as D}from"./index-B6NfvoMi.js";const I={class:"container my-8"},S=e("div",{class:"row my-3 text-center fs-6"},[e("div",{class:"col-4 text-primary fw-bold"},"1.購物清單"),e("div",{class:"col-4 text-primary fw-bold"},"2.填寫資料"),e("div",{class:"col-4 text-muted"},"3.完成訂單")],-1),O={class:"progress"},L=["aria-valuenow"],P={class:"row mt-5"},R={class:"col-md-6"},A={class:"p-5"},G=e("h2",{class:"border-bottom border-4 border-warning fs-4 fw-bold pb-3"},"清單列表",-1),H={class:"cart-list-body mt-4 d-flex"},J={class:"d-flex flex-grow-1"},K=["src","alt"],Q={class:"d-flex flex-column justify-content-start ms-3 mt-2"},W={class:"fs-5 fw-bold text-black mb-3"},X={class:"d-sm-none d-flex align-items-end"},Y={class:"fw-bold fs-7 mt-3"},Z={class:"fs-8 text-muted ms-2"},ee={class:"d-sm-flex flex-sm-column mt-1"},se={class:"d-none d-sm-block"},oe={class:"mb-2 fw-bold fs-5"},te={class:"fs-7 text-muted d-flex flex-column align-items-end"},ae={key:0,class:"border-top border-4 border-warning mt-4"},le={class:"text-end fw-bold text-primary fs-4 mt-4"},re={class:"col-md-6"},de=e("h2",{class:"border-bottom border-4 border-warning fs-4 fw-bold pb-3"},"填寫資料",-1),ne={class:"form-floating my-3"},ie=e("label",{for:"name",class:"form-label"},[e("span",{class:"text-danger"},"* "),_("姓名 ")],-1),ce={class:"form-floating my-3"},me=e("label",{for:"tel",class:"form-label"},[e("span",{class:"text-danger"},"* "),_("連絡電話")],-1),ue={class:"form-floating my-3"},fe=e("label",{for:"email",class:"form-label"},[e("span",{class:"text-danger"},"* "),_("Email")],-1),pe={class:"form-floating my-3"},_e=e("label",{for:"address",class:"form-label"},[e("span",{class:"text-danger"},"* "),_("寄送地址")],-1),be={class:"mt-4"},ve=e("label",{for:"message",class:"form-label fs6 ps-2"},"備註",-1),he={class:"d-flex justify-content-around p-0 mt-4"},ge=["disabled"],we={__name:"CheckOrder",setup(xe){const b=n(15);function V(s){b.value=s}const i=n({carts:[]}),g=C();function v(){w.get("https://vue3-course-api.hexschool.io/v2/api/kjwapi/cart").then(s=>{i.value=s.data.data}).catch(s=>{console.error(s.response)})}const a={user:{name:n(""),tel:n(""),email:n(""),address:n("")},message:""};function k(){w.post("https://vue3-course-api.hexschool.io/v2/api/kjwapi/order",{data:a}).then(s=>{const{orderId:t}=s.data;g.push(`/checkout/${t}`)}).catch(s=>{console.error("Error:",s.response)})}function $(){g.go(-1)}return E(()=>{let s=15;const t=setInterval(()=>{s>=50?clearInterval(t):(s+=5,V(s))},50);v(),y.on("get-cart",v)}),F(()=>{y.off("get-cart",v)}),(s,t)=>{var x;const c=h("VField"),m=h("ErrorMessage"),q=h("VForm");return f(),u("div",I,[S,e("div",O,[e("div",{class:"progress-bar bg-primary",role:"progressbar",style:T({width:b.value+"%"}),"aria-valuenow":b.value,"aria-valuemin":"0","aria-valuemax":"100"},null,12,L)]),e("div",P,[e("div",R,[e("div",A,[G,(f(!0),u(U,null,j(i.value.carts,o=>(f(),u("div",{key:o.id},[e("div",H,[e("div",J,[e("img",{class:"cart-img rounded-3",src:o.product.imageUrl,alt:o.title},null,8,K),e("div",Q,[e("h1",W,d(o.product.title),1),e("p",null,"數量："+d(o.qty),1),e("div",X,[e("p",Y," NT$ "+d(s.$filters.currency(o.product.price*o.qty)),1),e("del",Z," NT$ "+d(s.$filters.currency(o.product.origin_price*o.qty)),1)])])]),e("div",ee,[e("div",se,[e("p",oe," NT$ "+d(s.$filters.currency(o.product.price*o.qty)),1),e("del",te," NT$ "+d(s.$filters.currency(o.product.origin_price*o.qty)),1)])])])]))),128)),(x=i.value.carts)!=null&&x.length?(f(),u("div",ae,[e("p",le," 總金額 NT$ "+d(s.$filters.currency(i.value.final_total)),1)])):B("",!0)])]),e("div",re,[r(q,{class:"border rounded-3 shadow p-4 p-md-5",ref:"form",onSubmit:k},{default:M(({errors:o,meta:N})=>[de,e("div",ne,[r(c,{modelValue:a.user.name,"onUpdate:modelValue":t[0]||(t[0]=l=>a.user.name=l),id:"name",name:"姓名",type:"text",class:p(["form-control border-0 border-bottom fs-5",{"is-invalid":o.姓名}]),rules:"required",placeholder:"請輸入姓名"},null,8,["modelValue","class"]),ie,r(m,{name:"姓名",class:"invalid-feedback"})]),e("div",ce,[r(c,{modelValue:a.user.tel,"onUpdate:modelValue":t[1]||(t[1]=l=>a.user.tel=l),id:"tel",name:"電話",type:"text",class:p(["form-control border-0 border-bottom fs-5",{"is-invalid":o.電話}]),rules:"required|min:8|max:10",placeholder:"請輸入電話"},null,8,["modelValue","class"]),me,r(m,{name:"電話",class:"invalid-feedback"})]),e("div",ue,[r(c,{modelValue:a.user.email,"onUpdate:modelValue":t[2]||(t[2]=l=>a.user.email=l),id:"email",name:"Email",type:"email",class:p(["form-control border-0 border-bottom fs-5",{"is-invalid":o.Email}]),rules:"required|email",placeholder:"請輸入信箱"},null,8,["modelValue","class"]),fe,r(m,{name:"Email",class:"invalid-feedback"})]),e("div",pe,[r(c,{modelValue:a.user.address,"onUpdate:modelValue":t[3]||(t[3]=l=>a.user.address=l),id:"address",name:"地址",type:"text",class:p([{"is-invalid":o.地址},"form-control border-0 border-bottom fs-5"]),rules:"required",placeholder:"請輸入地址"},null,8,["modelValue","class"]),_e,r(m,{name:"地址",class:"invalid-feedback"})]),e("div",be,[ve,z(e("textarea",{id:"message",class:"form-control form-floating border border-1",cols:"20",rows:"5","onUpdate:modelValue":t[4]||(t[4]=l=>a.message=l)},null,512),[[D,a.message]])]),e("div",he,[e("button",{type:"button",class:"btn text-muted w-50 fs-5 border border-2 me-3",onClick:t[5]||(t[5]=l=>$())}," 返回 "),e("button",{type:"submit",class:"btn btn-primary shadow text-white w-50 fw-bold fs-5",disabled:!N.valid}," 下一步 ",8,ge)])]),_:1},512)])])])}}};export{we as default};
