import{r as l,x as V,y as I,o as R,d as i,f as n,w as r,g as t,i as U,z as q,s as G,F as b,k as x,l as w,b as N,c as a,h as k,A as H,t as d,j as T,q as J,e as K}from"./index-BjHk-I6Y.js";import{_ as O}from"./PaginationCom-G1RbcVtI.js";import{S as $}from"./sweetalert2.all-BDP4SNOs.js";import{u as Q}from"./favoriteStore-DpRavrKC.js";const W=t("div",{class:"loader-container"},[t("div",{class:"loader"}),t("div",{class:"text-white text-center fs-4 mt-2"},"喝杯熱茶，稍等片刻 ~ ~")],-1),X={class:"container my-7"},Y={class:"d-sm-flex justify-content-sm-between"},Z={"aria-label":"breadcrumb "},tt={class:"breadcrumb"},et={class:"breadcrumb-item"},st=t("i",{class:"bi bi-house-door-fill"},null,-1),ot={class:"breadcrumb-item active","aria-current":"page"},at={class:"d-flex"},it=t("span",{class:"material-icons-outlined text-white"},[t("i",{class:"bi bi-search"})],-1),lt=[it],ct={class:"search-result p-3 fs-7"},nt={class:"menu row mt-5"},rt={class:"category ps-md-5 col-md-6 col-lg-3"},dt={class:"list-active d-flex d-md-block justify-content-evenly list-unstyled mt-3"},ut=["onClick"],_t={class:"fs-5"},pt={class:"col-md-6 col-lg-9"},ft={key:0,class:"text-center pt-4"},ht=t("span",{class:"material-icons-outlined sentiment_dissatisfied fs-1 text-primary pb-3"},[t("i",{class:"bi bi-emoji-dizzy"})],-1),vt=t("p",{class:"text-muted mb-4 fs-5 fw-bold"},"沒有符合條件的搜尋結果！",-1),mt=[ht,vt],bt={key:1,class:"row row-cols-1 row-cols-sm-2 row-cols-xl-3 g-4"},gt={class:"card border-width h-100 shadow position-relative"},yt=["onClick"],xt={key:0,class:"material-icons-outlined favorite position-absolute text-white"},wt=t("i",{class:"bi bi-heart-fill"},null,-1),kt=[wt],$t={key:1,class:"material-icons-outlined favorite position-absolute text-white"},Ct=t("i",{class:"bi bi-heart"},null,-1),jt=[Ct],St={class:"card-body d-flex align-items-end justify-content-between"},Lt={class:"card-body-content"},Pt={key:0,class:"price fs-5 fw-bold text-primary mt-3"},Vt={key:1,class:"origin-price d-flex mt-3"},Nt={class:"fs-5 pe-2 text-primary fs-5 fw-bold"},Tt={class:"fs-6 text-muted"},zt=["onClick"],Bt=t("a",{class:"cart-icon text-primary fs-2 me-2"},[t("span",{class:"material-icons-outlined"},[t("i",{class:"bi bi-cart-plus-fill"})])],-1),Ft=[Bt],Rt={__name:"ProductsView",setup(Et){const u=l("false"),h=l([]),_=l({}),g=l([]);function v(s=1){document.documentElement.scrollTop=0,u.value=!0,w.get(`https://vue3-course-api.hexschool.io/v2/api/kjwapi/products/?page=${s}&category=${y.value}`).then(o=>{h.value=o.data.products,_.value=o.data.pagination,u.value=!1,console.log(o.data)}).catch(o=>{$.fire({icon:"error",title:"錯誤",text:o.response.data.message}),console.error("錯誤訊息:",o.response)})}function z(){w.get("https://vue3-course-api.hexschool.io/v2/api/kjwapi/products/all").then(s=>{g.value=s.data.products,M(),console.log(s.data)}).catch(s=>{$.fire({icon:"error",title:"錯誤",text:s.response.data.message}),console.error("錯誤訊息:",s.response)})}const B=Q(),{toggleFavorite:F,isFavorite:E}=B,C=l("");function A(s,o=1){u.value=!0,C.value=s,w.post("https://vue3-course-api.hexschool.io/v2/api/kjwapi/cart",{data:{product_id:s,qty:o}}).then(()=>{C.value="",K.emit("get-cart"),$.fire({position:"top-end",icon:"success",title:"已加入購物車",showConfirmButton:!1,timer:1e3}),u.value=!1}).catch(f=>{console.error(f.response)})}const y=l(""),j=l([]);function M(){const s=g.value.map(o=>o.category);j.value=[...new Set(s)]}function S(s){y.value=s}const p=l(""),m=l(!1);function D(){h.value=L.value,m.value=!1,p.value=""}V(y,()=>{v()}),V(p,s=>{s?(m.value=!0,_.value.current_page=1,_.value.total_pages=1,_.value.has_next=!1):m.value=!1});const L=I(()=>{const s=p.value.split(" "),o=[];return s.forEach(f=>{g.value.forEach(c=>{c.title.includes(f)&&o.push(c)})}),[...new Set(o)]});return R(()=>{v(),z()}),(s,o)=>{const f=N("VLoading"),c=N("RouterLink");return a(),i(b,null,[n(f,{active:u.value},{default:r(()=>[W]),_:1},8,["active"]),t("div",X,[t("div",Y,[t("nav",Z,[t("ol",tt,[t("li",et,[n(c,{to:"/",class:"fw-bold text-decoration-none"},{default:r(()=>[st,k(" 首頁")]),_:1})]),t("li",ot,[n(c,{to:"/products",class:"text-decoration-none",onClick:v},{default:r(()=>[k("所有商品")]),_:1})])])]),t("div",null,[t("div",at,[U(t("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=e=>p.value=e),placeholder:"請輸入關鍵字",class:"form-control fs-7 px-2 rounded-0 border border-1 border-muted w-100"},null,512),[[q,p.value,void 0,{trim:!0}]]),t("button",{type:"submit",class:"btn bg-primary d-flex align-items-center rounded-0",onClick:D},lt)]),t("ul",{class:G(["search-list shadow mt-2 position-absolute list-unstyled",m.value?"":"d-none"])},[(a(!0),i(b,null,x(L.value,e=>(a(),H(c,{key:e.title,class:"text-decoration-none",to:`/product/${e.id}`},{default:r(()=>[t("li",ct,d(e.title),1)]),_:2},1032,["to"]))),128))],2)])]),t("div",nt,[t("div",rt,[t("h2",{class:"mb-4 fs-4 fw-bold text-primary d-flex align-items-center justify-content-center justify-content-md-start",onClick:o[1]||(o[1]=e=>S(""))}," 商品分類 "),t("ul",dt,[(a(!0),i(b,null,x(j.value,e=>(a(),i("li",{class:"mb-4",key:`類別_${e}`,onClick:P=>S(e)},[t("a",null,[t("h2",_t,d(e),1)])],8,ut))),128))])]),t("div",pt,[h.value.length===0?(a(),i("div",ft,mt)):(a(),i("div",bt,[(a(!0),i(b,null,x(h.value,e=>(a(),i("div",{class:"col",key:e.id},[t("div",gt,[t("div",{class:"fs-3 fav-icon position-absolute position-relative",onClick:P=>T(F)(e)},[T(E)(e.id)?(a(),i("span",xt,kt)):(a(),i("span",$t,jt))],8,yt),n(c,{to:`/product/${e.id}`},{default:r(()=>[t("div",{class:"card-img",style:J({backgroundImage:`url(${e.imageUrl})`})},null,4)]),_:2},1032,["to"]),t("div",St,[t("div",Lt,[n(c,{class:"card-title fs-5 text-black text-decoration-none fw-bold lh-base mb-2",to:`/product/${e.id}`},{default:r(()=>[k(d(e.title),1)]),_:2},1032,["to"]),e.origin_price===e.price?(a(),i("div",Pt," NT$ "+d(s.$filters.currency(e.price))+" 元 ",1)):(a(),i("div",Vt,[t("p",Nt," NT$ "+d(s.$filters.currency(e.price))+" 元 ",1),t("del",Tt," NT$ "+d(s.$filters.currency(e.origin_price))+" 元",1)]))]),t("div",{onClick:P=>A(e.id)},Ft,8,zt)])])]))),128))]))]),n(O,{class:"d-flex justify-content-md-end justify-content-center mt-5",pages:_.value,onGetPage:v},null,8,["pages"])])])],64)}}};export{Rt as default};
