import{r as l,x as V,y as I,o as R,d as a,f as n,w as r,g as t,i as U,z as q,s as G,F as b,k as w,l as k,b as N,c as i,h as g,t as d,j as T,q as H,e as J}from"./index-CyAoszrq.js";import{_ as K}from"./PaginationCom-C_dDP_H4.js";import{S as $}from"./sweetalert2.all-CoQWtg_d.js";import{u as O}from"./favoriteStore-TKUujXST.js";const Q=t("div",{class:"loader-container"},[t("div",{class:"loader"}),t("div",{class:"text-white text-center fs-4 mt-2"},"喝杯熱茶，稍等片刻 ~ ~")],-1),W={class:"container my-7"},X={class:"d-sm-flex justify-content-sm-between"},Y={"aria-label":"breadcrumb "},Z={class:"breadcrumb"},tt={class:"breadcrumb-item"},et=t("i",{class:"bi bi-house-door-fill"},null,-1),st={class:"breadcrumb-item active","aria-current":"page"},ot={class:"d-flex"},at=t("span",{class:"material-icons-outlined text-white"},[t("i",{class:"bi bi-search"})],-1),it=[at],lt={class:"menu row mt-5"},ct={class:"category ps-md-5 col-md-6 col-lg-3"},nt={class:"list-active d-flex d-md-block justify-content-evenly list-unstyled mt-3"},rt=["onClick"],dt={class:"fs-5"},ut={class:"col-md-6 col-lg-9"},_t={key:0,class:"text-center pt-4"},pt=t("span",{class:"material-icons-outlined sentiment_dissatisfied fs-1 text-primary pb-3"},[t("i",{class:"bi bi-emoji-dizzy"})],-1),ft=t("p",{class:"text-muted mb-4 fs-5 fw-bold"},"沒有符合條件的搜尋結果！",-1),ht=[pt,ft],vt={key:1,class:"row row-cols-1 row-cols-sm-2 row-cols-xl-3 g-4"},mt={class:"card border-width h-100 shadow position-relative"},bt=["onClick"],gt={key:0,class:"material-icons-outlined favorite position-absolute text-white"},yt=t("i",{class:"bi bi-heart-fill"},null,-1),xt=[yt],wt={key:1,class:"material-icons-outlined favorite position-absolute text-white"},kt=t("i",{class:"bi bi-heart"},null,-1),$t=[kt],Ct={class:"card-body d-flex align-items-end justify-content-between"},jt={class:"card-body-content"},St={key:0,class:"price fs-5 fw-bold text-primary mt-3"},Lt={key:1,class:"origin-price d-flex mt-3"},Pt={class:"fs-5 pe-2 text-primary fs-5 fw-bold"},Vt={class:"fs-6 text-muted"},Nt=["onClick"],Tt=t("a",{class:"cart-icon text-primary fs-2 me-2"},[t("span",{class:"material-icons-outlined"},[t("i",{class:"bi bi-cart-plus-fill"})])],-1),zt=[Tt],Dt={__name:"ProductsView",setup(Ft){const u=l("false"),h=l([]),_=l({}),y=l([]);function v(s=1){document.documentElement.scrollTop=0,u.value=!0,k.get(`https://vue3-course-api.hexschool.io/v2/api/kjwapi/products/?page=${s}&category=${x.value}`).then(o=>{h.value=o.data.products,_.value=o.data.pagination,u.value=!1,console.log(o.data)}).catch(o=>{$.fire({icon:"error",title:"錯誤",text:o.response.data.message}),console.error("錯誤訊息:",o.response)})}function z(){k.get("https://vue3-course-api.hexschool.io/v2/api/kjwapi/products/all").then(s=>{y.value=s.data.products,A(),console.log(s.data)}).catch(s=>{$.fire({icon:"error",title:"錯誤",text:s.response.data.message}),console.error("錯誤訊息:",s.response)})}const F=O(),{toggleFavorite:B,isFavorite:E}=F,C=l("");function M(s,o=1){u.value=!0,C.value=s,k.post("https://vue3-course-api.hexschool.io/v2/api/kjwapi/cart",{data:{product_id:s,qty:o}}).then(()=>{C.value="",J.emit("get-cart"),$.fire({position:"top-end",icon:"success",title:"已加入購物車",showConfirmButton:!1,timer:1e3}),u.value=!1}).catch(f=>{console.error(f.response)})}const x=l(""),j=l([]);function A(){const s=y.value.map(o=>o.category);j.value=[...new Set(s)]}function S(s){x.value=s}const p=l(""),m=l(!1);function D(){h.value=L.value,m.value=!1,p.value=""}V(x,()=>{v()}),V(p,s=>{s?(m.value=!0,_.value.current_page=1,_.value.total_pages=1,_.value.has_next=!1):m.value=!1});const L=I(()=>{const s=p.value.split(" "),o=[];return s.forEach(f=>{y.value.forEach(c=>{c.title.includes(f)&&o.push(c)})}),[...new Set(o)]});return R(()=>{v(),z()}),(s,o)=>{const f=N("VLoading"),c=N("RouterLink");return i(),a(b,null,[n(f,{active:u.value},{default:r(()=>[Q]),_:1},8,["active"]),t("div",W,[t("div",X,[t("nav",Y,[t("ol",Z,[t("li",tt,[n(c,{to:"/",class:"fw-bold text-decoration-none"},{default:r(()=>[et,g(" 首頁")]),_:1})]),t("li",st,[n(c,{to:"/products",class:"text-decoration-none",onClick:v},{default:r(()=>[g("所有商品")]),_:1})])])]),t("div",null,[t("div",ot,[U(t("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=e=>p.value=e),placeholder:"請輸入關鍵字",class:"form-control fs-7 px-2 rounded-0 border border-1 border-muted w-100"},null,512),[[q,p.value,void 0,{trim:!0}]]),t("button",{type:"submit",class:"btn bg-primary d-flex align-items-center rounded-0",onClick:D},it)]),t("ul",{class:G(["search-list shadow mt-2 position-absolute list-unstyled",m.value?"":"d-none"])},[(i(!0),a(b,null,w(L.value,e=>(i(),a("li",{class:"search-result p-3 fs-7",key:e.title},[n(c,{class:"text-decoration-none",to:`/product/${e.id}`},{default:r(()=>[g(d(e.title),1)]),_:2},1032,["to"])]))),128))],2)])]),t("div",lt,[t("div",ct,[t("h2",{class:"mb-4 fs-4 fw-bold text-primary d-flex align-items-center justify-content-center justify-content-md-start",onClick:o[1]||(o[1]=e=>S(""))}," 商品分類 "),t("ul",nt,[(i(!0),a(b,null,w(j.value,e=>(i(),a("li",{class:"mb-4",key:`類別_${e}`,onClick:P=>S(e)},[t("a",null,[t("h2",dt,d(e),1)])],8,rt))),128))])]),t("div",ut,[h.value.length===0?(i(),a("div",_t,ht)):(i(),a("div",vt,[(i(!0),a(b,null,w(h.value,e=>(i(),a("div",{class:"col",key:e.id},[t("div",mt,[t("div",{class:"fs-3 fav-icon position-absolute position-relative",onClick:P=>T(B)(e)},[T(E)(e.id)?(i(),a("span",gt,xt)):(i(),a("span",wt,$t))],8,bt),n(c,{to:`/product/${e.id}`},{default:r(()=>[t("div",{class:"card-img",style:H({backgroundImage:`url(${e.imageUrl})`})},null,4)]),_:2},1032,["to"]),t("div",Ct,[t("div",jt,[n(c,{class:"card-title fs-5 text-black text-decoration-none fw-bold lh-base mb-2",to:`/product/${e.id}`},{default:r(()=>[g(d(e.title),1)]),_:2},1032,["to"]),e.origin_price===e.price?(i(),a("div",St," NT$ "+d(s.$filters.currency(e.price))+" 元 ",1)):(i(),a("div",Lt,[t("p",Pt," NT$ "+d(s.$filters.currency(e.price))+" 元 ",1),t("del",Vt," NT$ "+d(s.$filters.currency(e.origin_price))+" 元",1)]))]),t("div",{onClick:P=>M(e.id)},zt,8,Nt)])])]))),128))]))]),n(K,{class:"d-flex justify-content-md-end justify-content-center mt-5",pages:_.value,onGetPage:v},null,8,["pages"])])])],64)}}};export{Dt as default};
