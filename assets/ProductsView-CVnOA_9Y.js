import{r as c,x as N,y as U,o as q,d as i,f as r,w as d,g as t,i as G,z as H,s as J,F as y,k,l as $,b as T,c as a,h as C,A as K,t as u,j as z,q as O,e as Q,p as W,n as X}from"./index-B6NfvoMi.js";import{_ as Y}from"./PaginationCom-jHCsgtq7.js";import{S as j}from"./sweetalert2.all-2OC8-NOp.js";import{u as Z}from"./favoriteStore-B-d2UUn5.js";import{_ as tt}from"./plugin-vueexport-helper-DlAUqK2U.js";const n=v=>(W("data-v-eae56af2"),v=v(),X(),v),et=n(()=>t("div",{class:"loader-container"},[t("div",{class:"loader"}),t("div",{class:"text-white text-center fs-4 mt-2"},"喝杯熱茶，稍等片刻 ~ ~")],-1)),st={class:"container my-7"},ot={class:"d-sm-flex justify-content-sm-between"},at={"aria-label":"breadcrumb "},it={class:"breadcrumb"},ct={class:"breadcrumb-item"},lt=n(()=>t("i",{class:"bi bi-house-door-fill"},null,-1)),nt={class:"breadcrumb-item active","aria-current":"page"},rt={class:"d-flex"},dt=n(()=>t("span",{class:"material-icons-outlined text-white"},[t("i",{class:"bi bi-search"})],-1)),ut=[dt],_t={class:"search-result p-3 fs-7"},pt={class:"menu row mt-5"},ft={class:"category ps-md-5 col-md-6 col-lg-3"},ht={class:"list-active d-flex d-md-block justify-content-evenly list-unstyled mt-3"},vt=["onClick"],mt={class:"fs-5"},bt={class:"col-md-6 col-lg-9"},gt={key:0,class:"text-center pt-4"},yt=n(()=>t("span",{class:"material-icons-outlined sentiment_dissatisfied fs-1 text-primary pb-3"},[t("i",{class:"bi bi-emoji-dizzy"})],-1)),xt=n(()=>t("p",{class:"text-muted mb-4 fs-5 fw-bold"},"沒有符合條件的搜尋結果！",-1)),wt=[yt,xt],kt={key:1,class:"row row-cols-1 row-cols-sm-2 row-cols-xl-3 g-4"},$t={class:"card border-width h-100 shadow position-relative"},Ct=["onClick"],jt={key:0,class:"material-icons-outlined favorite position-absolute text-white"},St=n(()=>t("i",{class:"bi bi-heart-fill"},null,-1)),Pt=[St],Vt={key:1,class:"material-icons-outlined favorite position-absolute text-white"},Lt=n(()=>t("i",{class:"bi bi-heart"},null,-1)),It=[Lt],Nt={class:"card-body d-flex align-items-end justify-content-between"},Tt={class:"card-body-content"},zt={key:0,class:"price fs-5 fw-bold text-primary mt-3"},Bt={key:1,class:"origin-price d-flex mt-3"},Ft={class:"fs-5 pe-2 text-primary fs-5 fw-bold"},Et={class:"fs-6 text-muted"},At=["onClick"],Mt=n(()=>t("a",{class:"cart-icon text-primary fs-2 me-2"},[t("span",{class:"material-icons-outlined"},[t("i",{class:"bi bi-cart-plus-fill"})])],-1)),Dt=[Mt],Rt={__name:"ProductsView",setup(v){const _=c("false"),m=c([]),p=c({}),x=c([]);function b(s=1){document.documentElement.scrollTop=0,_.value=!0,$.get(`https://vue3-course-api.hexschool.io/v2/api/kjwapi/products/?page=${s}&category=${w.value}`).then(o=>{m.value=o.data.products,p.value=o.data.pagination,_.value=!1,console.log(o.data)}).catch(o=>{j.fire({icon:"error",title:"錯誤",text:o.response.data.message}),console.error("錯誤訊息:",o.response)})}function B(){$.get("https://vue3-course-api.hexschool.io/v2/api/kjwapi/products/all").then(s=>{x.value=s.data.products,D(),console.log(s.data)}).catch(s=>{j.fire({icon:"error",title:"錯誤",text:s.response.data.message}),console.error("錯誤訊息:",s.response)})}const F=Z(),{toggleFavorite:E,isFavorite:A}=F,S=c("");function M(s,o=1){_.value=!0,S.value=s,$.post("https://vue3-course-api.hexschool.io/v2/api/kjwapi/cart",{data:{product_id:s,qty:o}}).then(()=>{S.value="",Q.emit("get-cart"),j.fire({position:"top-end",icon:"success",title:"已加入購物車",showConfirmButton:!1,timer:1e3}),_.value=!1}).catch(h=>{console.error(h.response)})}const w=c(""),P=c([]);function D(){const s=x.value.map(o=>o.category);P.value=[...new Set(s)]}function V(s){w.value=s}const f=c(""),g=c(!1);function R(){m.value=L.value,g.value=!1,f.value=""}N(w,()=>{b()}),N(f,s=>{s?(g.value=!0,p.value.current_page=1,p.value.total_pages=1,p.value.has_next=!1):g.value=!1});const L=U(()=>{const s=f.value.split(" "),o=[];return s.forEach(h=>{x.value.forEach(l=>{l.title.includes(h)&&o.push(l)})}),[...new Set(o)]});return q(()=>{b(),B()}),(s,o)=>{const h=T("VLoading"),l=T("RouterLink");return a(),i(y,null,[r(h,{active:_.value},{default:d(()=>[et]),_:1},8,["active"]),t("div",st,[t("div",ot,[t("nav",at,[t("ol",it,[t("li",ct,[r(l,{to:"/",class:"fw-bold text-decoration-none"},{default:d(()=>[lt,C(" 首頁")]),_:1})]),t("li",nt,[r(l,{to:"/products",class:"text-decoration-none",onClick:b},{default:d(()=>[C("所有商品")]),_:1})])])]),t("div",null,[t("div",rt,[G(t("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=e=>f.value=e),placeholder:"請輸入關鍵字",class:"form-control fs-7 px-2 rounded-0 border border-1 border-muted w-100"},null,512),[[H,f.value,void 0,{trim:!0}]]),t("button",{type:"submit",class:"btn bg-primary d-flex align-items-center rounded-0",onClick:R},ut)]),t("ul",{class:J(["search-list shadow mt-2 position-absolute list-unstyled",g.value?"":"d-none"])},[(a(!0),i(y,null,k(L.value,e=>(a(),K(l,{key:e.title,class:"text-decoration-none",to:`/product/${e.id}`},{default:d(()=>[t("li",_t,u(e.title),1)]),_:2},1032,["to"]))),128))],2)])]),t("div",pt,[t("div",ft,[t("h2",{class:"mb-4 fs-4 fw-bold text-primary d-flex align-items-center justify-content-center justify-content-md-start",onClick:o[1]||(o[1]=e=>V(""))}," 商品分類 "),t("ul",ht,[(a(!0),i(y,null,k(P.value,e=>(a(),i("li",{class:"mb-4",key:`類別_${e}`,onClick:I=>V(e)},[t("a",null,[t("h2",mt,u(e),1)])],8,vt))),128))])]),t("div",bt,[m.value.length===0?(a(),i("div",gt,wt)):(a(),i("div",kt,[(a(!0),i(y,null,k(m.value,e=>(a(),i("div",{class:"col",key:e.id},[t("div",$t,[t("div",{class:"fs-3 fav-icon position-absolute position-relative",onClick:I=>z(E)(e)},[z(A)(e.id)?(a(),i("span",jt,Pt)):(a(),i("span",Vt,It))],8,Ct),r(l,{to:`/product/${e.id}`},{default:d(()=>[t("div",{class:"card-img",style:O({backgroundImage:`url(${e.imageUrl})`})},null,4)]),_:2},1032,["to"]),t("div",Nt,[t("div",Tt,[r(l,{class:"card-title fs-5 text-black text-decoration-none fw-bold lh-base mb-2",to:`/product/${e.id}`},{default:d(()=>[C(u(e.title),1)]),_:2},1032,["to"]),e.origin_price===e.price?(a(),i("div",zt," NT$ "+u(s.$filters.currency(e.price))+" 元 ",1)):(a(),i("div",Bt,[t("p",Ft," NT$ "+u(s.$filters.currency(e.price))+" 元 ",1),t("del",Et," NT$ "+u(s.$filters.currency(e.origin_price))+" 元",1)]))]),t("div",{onClick:I=>M(e.id)},Dt,8,At)])])]))),128))]))]),r(Y,{class:"d-flex justify-content-md-end justify-content-center mt-5",pages:p.value,onGetPage:b},null,8,["pages"])])])],64)}}},Kt=tt(Rt,[["__scopeId","data-v-eae56af2"]]);export{Kt as default};
