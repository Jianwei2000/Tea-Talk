import{r as p,J as P,o as j,d as c,f as $,w as D,g as e,F as U,k as N,i as n,z as d,K as S,h as g,t as m,l as f,b as T,c as r}from"./index-BjHk-I6Y.js";import{_ as F}from"./PaginationCom-G1RbcVtI.js";import{S as _}from"./sweetalert2.all-BDP4SNOs.js";import{M as v}from"./modal-DPp0hoxY.js";const z=e("div",{class:"loader-container"},[e("div",{class:"loader"}),e("div",{class:"text-white text-center fs-4 mt-2"},"喝杯熱茶，稍等片刻 ~ ~")],-1),A={class:"container mt-5"},G={class:"d-flex justify-content-between"},J=e("h3",{class:"fw-bold"},[e("i",{class:"bi bi-box-seam"}),g(" 商品列表")],-1),K={class:"table-responsive"},q={class:"table table-striped mb-4"},H=e("thead",null,[e("tr",null,[e("th",null,"商品名稱"),e("th",{class:"d-none d-md-table-cell"},"分類"),e("th",{class:"d-none d-md-table-cell"},"原價"),e("th",null,"售價"),e("th",null,"是否啟用"),e("th",null,"操作")])],-1),O={class:"d-none d-md-table-cell"},Q={class:"d-none d-md-table-cell"},R={key:0,class:"text-success"},W={key:1,class:"text-danger"},X={class:"btn-group"},Y=["onClick"],Z=["onClick"],ee={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},te={class:"modal-dialog modal-xl",role:"document"},oe={class:"modal-content border-0"},le={class:"modal-header bg-dark text-white"},se={class:"modal-title",id:"exampleModalLabel"},ae={key:0},ne={key:1},de=e("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ie={class:"modal-body"},ce={class:"row"},re={class:"col-sm-4"},ue={class:"mb-3"},pe=e("label",{for:"image",class:"form-label h3"},"商品圖片",-1),me=e("label",{for:"fileInput",class:"form-label"}," 或 上傳圖片 ",-1),_e=["src"],be={class:"col-sm-8"},he={class:"mb-3"},fe=e("label",{for:"title",class:"form-label"},"標題",-1),ve={class:"row"},ge={class:"mb-3 col-md-6"},ye=e("label",{for:"category",class:"form-label"},"分類",-1),xe={class:"mb-3 col-md-6"},ke=e("label",{for:"price",class:"form-label"},"庫存",-1),we={class:"row"},Me={class:"mb-3 col-md-6"},Ce=e("label",{for:"origin_price",class:"form-label"},"原價",-1),$e={class:"mb-3 col-md-6"},Ue=e("label",{for:"price",class:"form-label"},"售價",-1),Ve=e("hr",null,null,-1),Be={class:"mb-3"},Le=e("label",{for:"description",class:"form-label"},"商品描述",-1),Ie={class:"mb-3"},Ee=e("label",{for:"content",class:"form-label"},"說明內容",-1),Pe={class:"mb-3"},je={class:"form-check form-switch"},De=e("label",{class:"form-check-label",for:"flexSwitchCheckChecked"},"是否啟用",-1),Ne=e("button",{type:"button",class:"btn btn-outline-danger","data-bs-dismiss":"modal","aria-label":"Close"}," 取消 ",-1),Se={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Te={class:"modal-dialog modal-md",role:"document"},Fe={class:"modal-content border-0"},ze=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},[e("span",null,"刪除商品")]),e("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ae={class:"modal-body"},Ge={class:"text-center fs-3"},Je={class:"text-light bg-info p-1 rounded-3"},Ke=e("br",null,null,-1),qe=e("button",{type:"button",class:"btn btn-outline-dark","data-bs-dismiss":"modal","aria-label":"Close"}," 取消 ",-1),Xe={__name:"AdminProducts",setup(He){const i=p(!1),x=p([]),k=p({});function b(s=1){i.value=!0,f.get(`https://vue3-course-api.hexschool.io/v2/api/kjwapi/admin/products?page=${s}`).then(o=>{x.value=o.data.products,k.value=o.data.pagination,console.log(o.data),i.value=!1}).catch(o=>{console.error("錯誤訊息:",o.response),i.value=!1})}const l=p({}),y=p(!1);function V(){new v(document.getElementById("productModal")).show()}function w(s,o={}){y.value=s,s?l.value={}:l.value={...o},V()}function B(){i.value=!0;let s="https://vue3-course-api.hexschool.io/v2/api/kjwapi/admin/product",o="post",a="新增產品";const t=document.getElementById("productModal");y.value||(s=`${s}/${l.value.id}`,o="put",a="更新產品"),f({method:o,url:s,data:{data:l.value}}).then(u=>{_.fire({icon:"success",title:"商品編輯成功",showConfirmButton:!1,timer:1500});const C=v.getInstance(t);C&&C.hide(),i.value=!1,console.log(u),b()}).catch(u=>{_.fire({icon:"error",title:"商品建立失敗",text:u.response.data.message,status:a}),i.value=!1,console.error(u.response,a)})}const h=P({imgUploading:!1}),M=p(null);function L(){l.value.imageUrl="",h.imgUploading=!0;const s=M.value.files[0],o=new FormData;o.append("file-to-upload",s),f.post("https://vue3-course-api.hexschool.io/v2/api/kjwapi/admin/upload",o,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{h.imgUploading=!1,t.data.success?l.value.imageUrl=t.data.imageUrl:_.fire({icon:"error",title:"圖片上傳失敗",text:t.data.message})}).catch(t=>{h.imgUploading=!1,console.error(t.response||t)})}function I(s){l.value={...s},new v(document.getElementById("delModal")).show()}function E(){let s=`https://vue3-course-api.hexschool.io/v2/api/kjwapi/admin/product/${l.value.id}`;const o=document.getElementById("delModal");f.delete(s).then(a=>{const t=v.getInstance(o);t&&t.hide(),_.fire({icon:"success",title:"已刪除商品",showConfirmButton:!1,timer:1500}),console.log(a),b()}).catch(a=>{_.fire({icon:"error",title:"刪除商品失敗",text:a.response.data.message,status:h}),console.error(a.response)})}return j(()=>{b()}),(s,o)=>{const a=T("VLoading");return r(),c(U,null,[$(a,{active:i.value},{default:D(()=>[z]),_:1},8,["active"]),e("div",A,[e("div",G,[J,e("button",{class:"btn btn-dark mb-4",type:"button",onClick:o[0]||(o[0]=t=>w(!0))}," 建立新的商品 ")]),e("div",K,[e("table",q,[H,e("tbody",null,[(r(!0),c(U,null,N(x.value,t=>(r(),c("tr",{key:t.id},[e("td",null,m(t.title),1),e("td",O,m(t.category),1),e("td",Q,"NT$"+m(s.$filters.currency(t.origin_price)),1),e("td",null,"NT$"+m(s.$filters.currency(t.price)),1),e("td",null,[t.is_enabled?(r(),c("span",R,"啟用")):(r(),c("span",W,"未啟用"))]),e("td",null,[e("div",X,[e("button",{type:"button",class:"btn btn-outline-dark btn-sm",onClick:u=>w(!1,t)}," 編輯 ",8,Y),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:u=>I(t)}," 刪除 ",8,Z)])])]))),128))])])]),$(F,{pages:k.value,onGetPage:b},null,8,["pages"]),e("div",ee,[e("div",te,[e("div",oe,[e("div",le,[e("h5",se,[y.value?(r(),c("span",ae,"新增產品")):(r(),c("span",ne,"編輯產品"))]),de]),e("div",ie,[e("div",ce,[e("div",re,[e("div",ue,[pe,n(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>l.value.imageUrl=t),id:"image",type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[d,l.value.imageUrl]]),me,e("input",{type:"file",class:"form-control mb-2",onChange:L,ref_key:"files",ref:M,id:"fileInput"},null,544),e("img",{class:"img-fluid",src:l.value.imageUrl},null,8,_e)])]),e("div",be,[e("div",he,[fe,n(e("input",{id:"title","onUpdate:modelValue":o[2]||(o[2]=t=>l.value.title=t),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[d,l.value.title]])]),e("div",ve,[e("div",ge,[ye,n(e("input",{id:"category","onUpdate:modelValue":o[3]||(o[3]=t=>l.value.category=t),type:"text",class:"form-control",placeholder:"請輸入分類"},null,512),[[d,l.value.category]])]),e("div",xe,[ke,n(e("input",{id:"unit","onUpdate:modelValue":o[4]||(o[4]=t=>l.value.unit=t),type:"text",class:"form-control",placeholder:"請輸入庫存"},null,512),[[d,l.value.unit]])])]),e("div",we,[e("div",Me,[Ce,n(e("input",{id:"origin_price","onUpdate:modelValue":o[5]||(o[5]=t=>l.value.origin_price=t),type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"},null,512),[[d,l.value.origin_price]])]),e("div",$e,[Ue,n(e("input",{id:"price","onUpdate:modelValue":o[6]||(o[6]=t=>l.value.price=t),type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"},null,512),[[d,l.value.price]])])]),Ve,e("div",Be,[Le,n(e("textarea",{id:"description","onUpdate:modelValue":o[7]||(o[7]=t=>l.value.description=t),type:"text",class:"form-control",placeholder:"請輸入商品描述",style:{"min-height":"150px"}},`\r
                  `,512),[[d,l.value.description]])]),e("div",Ie,[Ee,n(e("textarea",{type:"text",class:"form-control",id:"content","onUpdate:modelValue":o[8]||(o[8]=t=>l.value.content=t),placeholder:"請輸入商品說明內容"},null,512),[[d,l.value.content]])]),e("div",Pe,[e("div",je,[n(e("input",{id:"flexSwitchCheckChecked","onUpdate:modelValue":o[9]||(o[9]=t=>l.value.is_enabled=t),class:"form-check-input",type:"checkbox",role:"switch","true-value":1,"false-value":0},null,512),[[S,l.value.is_enabled]]),De])])])])]),e("div",{class:"modal-footer"},[Ne,e("button",{type:"button",class:"btn btn-dark",onClick:B},"確認")])])])]),e("div",Se,[e("div",Te,[e("div",Fe,[ze,e("div",Ae,[e("div",Ge,[g(" 是否刪除 "),e("strong",Je,m(l.value.title),1),g(" 商品 "),Ke,g(" (刪除後將無法恢復) ")])]),e("div",{class:"modal-footer"},[qe,e("button",{type:"button",class:"btn btn-outline-danger",onClick:E}," 確認刪除 ")])])])])])],64)}}};export{Xe as default};
